<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Online Translator | Nexo Translator - 50+ Languages</title>
    <meta name="description" content="Translate effortlessly with Nexo Translator! Free, professional translations in over 47 languages, including Hausa, Arabic, French, and Spanish. Modern, user-friendly interface—no registration needed.">
    <meta name="keywords" content="free translator, online translation, Hausa translator, Arabic translator, Yoruba translator, Igbo translator, multilingual translation, language converter, translate text, free translation service">
    <meta name="verify-admitad" content="b63cb1a621" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="author" content="Nexo Translator">
    <meta name="language" content="English">
    <meta name="revisit-after" content="1 day">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Free Online Translator | Nexo Translator - 50+ Languages">
    <meta property="og:description" content="Translate effortlessly with Nexo Translator! Free, professional translations in over 47 languages, including Hausa, Arabic, French, and Spanish. Modern, user-friendly interface—no registration needed.">
    <meta property="og:url" content="https://nexotranslator.live">
    <meta property="og:site_name" content="Nexo Translator">
    <meta property="og:locale" content="en_US">
    <meta property="og:image" content="https://nexotranslator.live/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Online Translator | Nexo Translator - 50+ Languages">
    <meta name="twitter:description" content="Translate effortlessly with Nexo Translator! Free, professional translations in over 47 languages, including Hausa, Arabic, French, and Spanish. Modern, user-friendly interface—no registration needed.">
    <meta name="twitter:image" content="https://nexotranslator.live/twitter-image.jpg">
    <meta name="twitter:site" content="@NexoTranslator">
    <meta name="twitter:creator" content="@NexoTranslator">
    <link rel="canonical" href="https://nexotranslator.live">
    <link rel="alternate" hreflang="en" href="https://nexotranslator.live">
    <link rel="alternate" hreflang="es" href="https://nexotranslator.live/es">
    <link rel="alternate" hreflang="fr" href="https://nexotranslator.live/fr">
    <link rel="alternate" hreflang="ar" href="https://nexotranslator.live/ar">
    <link rel="alternate" hreflang="ha" href="https://nexotranslator.live/ha">
    <link rel="alternate" hreflang="yo" href="https://nexotranslator.live/yo">
    <link rel="alternate" hreflang="ig" href="https://nexotranslator.live/ig">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌐</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" async>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Nexo Translator",
        "description": "Translate effortlessly with Nexo Translator! Free, professional translations in over 47 languages, including Hausa, Arabic, French, and Spanish. Modern, user-friendly interface—no registration needed.",
        "url": "https://nexotranslator.live",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "All",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "50+ Language Support",
            "Text-to-Speech",
            "Speech-to-Text",
            "Auto Language Detection",
            "Copy to Clipboard",
            "Translation History",
            "Mobile Friendly",
            "Favorite Translations"
        ],
        "author": {
            "@type": "Organization",
            "name": "Nexo Translator"
        },
        "provider": {
            "@type": "Organization",
            "name": "Nexo Translator",
            "url": "https://nexotranslator.live"
        },
        "inLanguage": ["en", "es", "fr", "ar", "ha", "yo", "ig"]
    }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap');
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:'SF Pro Display',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#fff;min-height:100vh;color:#000;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden;}
        body::before{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 15% 25%,rgba(0,0,0,0.015) 0%,transparent 60%),radial-gradient(circle at 85% 75%,rgba(0,0,0,0.02) 0%,transparent 60%),radial-gradient(circle at 50% 50%,rgba(0,0,0,0.005) 0%,transparent 100%);z-index:-1;}
        .container{max-width:1400px;margin:0 auto;padding:2rem;min-height:100vh;display:flex;flex-direction:column;align-items:center;gap:2.5rem;}
        .header{margin:1rem 0;text-align:center;animation:fadeInDown 0.8s ease-out;}
        .logo{display:flex;flex-direction:column;align-items:center;text-shadow:0 0 40px rgba(0,0,0,0.1);}
        .logo h1{font-size:2.5rem;font-weight:500;color:#000;text-transform:uppercase;}
        .logo span{font-size:1.2rem;font-weight:400;color:#4a4a4a;}
        .main-container{background:rgba(255,255,255,0.9);backdrop-filter:blur(60px);border:1px solid rgba(0,0,0,0.06);border-radius:24px;width:100%;max-width:1100px;animation:slideInUp 0.8s ease-out 0.2s both;box-shadow:0 32px 64px rgba(0,0,0,0.1),inset 0 1px 0 rgba(255,255,255,0.5);position:relative;}
        .main-container::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(0,0,0,0.15),transparent);}
        .language-bar{display:flex;align-items:center;padding:2rem;border-bottom:1px solid rgba(0,0,0,0.04);justify-content:space-between;}
        .language-selector{position:relative;min-width:200px;}
        .language-btn{background:rgba(0,0,0,0.03);backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,0.08);border-radius:14px;padding:1rem 1.25rem;color:#000;font-weight:400;font-size:0.95rem;cursor:pointer;transition:all 0.3s cubic-bezier(0.25,0.8,0.25,1);width:100%;display:flex;align-items:center;justify-content:space-between;}
        .language-btn:hover{background:rgba(0,0,0,0.06);border-color:rgba(0,0,0,0.12);transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,0.1);}
        .language-btn:focus{outline:2px solid #007bff;}
        .language-dropdown{position:absolute;top:calc(100% + 8px);left:0;right:0;background:rgba(255,255,255,0.95);backdrop-filter:blur(40px);border:1px solid rgba(0,0,0,0.08);border-radius:16px;max-height:320px;overflow-y:auto;z-index:1000;display:none;box-shadow:0 20px 40px rgba(0,0,0,0.2);scrollbar-width:thin;}
        .language-dropdown::-webkit-scrollbar{width:4px;}
        .language-dropdown::-webkit-scrollbar-track{background:rgba(0,0,0,0.02);border-radius:2px;}
        .language-dropdown::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.1);border-radius:2px;}
        .language-dropdown.active{display:block;animation:dropdownFade 0.25s ease-out;}
        .language-option{padding:0.875rem 1.25rem;cursor:pointer;transition:all 0.2s ease;font-size:0.9rem;display:flex;align-items:center;gap:0.75rem;color:#000;}
        .language-option:hover{background:rgba(0,0,0,0.04);}
        .language-option:focus{outline:2px solid #007bff;}
        .swap-btn{background:rgba(0,0,0,0.03);backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,0.08);border-radius:14px;width:52px;height:52px;color:#000;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.2rem;}
        .swap-btn:hover{background:rgba(0,0,0,0.06);transform:rotate(180deg) scale(1.05);box-shadow:0 8px 25px rgba(0,0,0,0.1);}
        .translation-container{display:grid;grid-template-columns:1fr 1fr;}
        .translation-container::before{content:'';position:absolute;top:0;bottom:0;left:50%;width:1px;background:linear-gradient(to bottom,transparent,rgba(0,0,0,0.04),transparent);transform:translateX(-50%);}
        .text-panel{position:relative;display:flex;flex-direction:column;}
        .text-area{width:100%;min-height:280px;background:rgba(255,255,255,0.8);backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,0.05);border-radius:16px;padding:2rem;color:#000;font-size:1.05rem;line-height:1.6;resize:none;outline:none;font-family:inherit;font-weight:300;}
        .text-area::placeholder{color:rgba(0,0,0,0.3);}
        .text-area:focus{background:rgba(255,255,255,0.9);border-color:rgba(0,0,0,0.1);box-shadow:0 4px 20px rgba(0,0,0,0.1);}
        .text-area[readonly]{background:rgba(255,255,255,0.85);border-color:rgba(0,0,0,0.08);}
        .panel-controls{position:absolute;bottom:1.25rem;right:1.25rem;display:flex;gap:0.5rem;opacity:0;transform:translateY(10px);transition:all 0.3s ease;}
        .text-panel:hover .panel-controls{opacity:1;transform:translateY(0);}
        .control-btn{background:rgba(0,0,0,0.04);backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,0.08);border-radius:10px;width:40px;height:40px;color:rgba(0,0,0,0.6);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:0.9rem;}
        .control-btn:hover{background:rgba(0,0,0,0.08);color:#000;transform:translateY(-2px);box-shadow:0 4px 15px rgba(0,0,0,0.1);}
        .control-btn.recording{background:rgba(255,0,0,0.2);color:#ff4444;border-color:rgba(255,0,0,0.3);animation:pulse 1.5s infinite;}
        @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,68,68,0.4);}70%{box-shadow:0 0 0 8px rgba(255,68,68,0);}100%{box-shadow:0 0 0 0 rgba(255,68,68,0);}}
        .char-count{position:absolute;bottom:1.25rem;left:2rem;color:rgba(0,0,0,0.25);font-size:0.8rem;}
        .bottom-bar{padding:2rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid rgba(0,0,0,0.04);}
        .detect-language{color:rgba(0,0,0,0.4);font-size:0.9rem;}
        .translate-btn{background:linear-gradient(135deg,#000,rgba(0,0,0,0.9));color:#fff;border:none;border-radius:12px;padding:0.875rem 2.5rem;font-weight:500;font-size:0.95rem;cursor:pointer;opacity:0;transform:translateY(10px);box-shadow:0 4px 20px rgba(0,0,0,0.1);}
        .translate-btn.visible{opacity:1;transform:translateY(0);}
        .translate-btn:hover{background:linear-gradient(135deg,rgba(0,0,0,0.95),rgba(0,0,0,0.85));transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,0.15);}
        .translate-btn:disabled{opacity:0.6;cursor:not-allowed;}
        .spinner{width:16px;height:16px;border:2px solid rgba(255,255,255,0.3);border-top:2px solid #fff;border-radius:50%;animation:spin 1s linear infinite;margin-right:0.5rem;}
        .error-message{color:#ff4444;font-size:0.9rem;text-align:center;margin-top:1rem;display:none;}
        .affiliate-ads{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem;width:100%;max-width:1100px;margin-top:2rem;}
        .affiliate-ad{background:linear-gradient(135deg,rgba(255,255,255,0.9),rgba(255,255,255,0.7));backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,0.05);border-radius:16px;padding:1.5rem;color:#000;text-decoration:none;min-height:120px;display:flex;align-items:center;box-shadow:0 4px 20px rgba(0,0,0,0.1);position:relative;}
        .affiliate-ad:hover{transform:translateY(-4px) scale(1.02);box-shadow:0 15px 40px rgba(0,0,0,0.15);}
        .alibaba-ad{background:linear-gradient(135deg,#FF6F00,#FF9F00);border-color:rgba(255,111,0,0.4);}
        .alibaba-ad:hover{border-color:rgba(255,111,0,0.6);box-shadow:0 15px 40px rgba(255,111,0,0.3);}
        .retouchme-ad{background:linear-gradient(135deg,#0000FF,#4D4DFF);border-color:rgba(0,0,255,0.4);}
        .retouchme-ad:hover{border-color:rgba(0,0,255,0.6);box-shadow:0 15px 40px rgba(0,0,255,0.3);}
        .ad-text h3{font-size:1.2rem;font-weight:600;margin-bottom:0.25rem;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,0.3);}
        .ad-text p{font-size:0.95rem;color:rgba(255,255,255,0.9);line-height:1.4;}
        .history-section{width:100%;max-width:1100px;background:rgba(255,255,255,0.9);backdrop-filter:blur(60px);border:1px solid rgba(0,0,0,0.06);border-radius:24px;padding:2rem;margin-top:2rem;box-shadow:0 4px 20px rgba(0,0,0,0.1);}
        .history-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
        .history-section h2{font-size:1.5rem;font-weight:500;}
        .clear-history-btn,.favorite-btn{background:linear-gradient(135deg,rgba(51,51,51,0.15),rgba(51,51,51,0.05));backdrop-filter:blur(20px);border:1px solid rgba(51,51,51,0.2);border-radius:12px;padding:0.75rem 1.5rem;color:#000;font-size:0.9rem;cursor:pointer;}
        .clear-history-btn:hover,.favorite-btn:hover{background:linear-gradient(135deg,rgba(51,51,51,0.25),rgba(51,51,51,0.1));transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.15);}
        .favorite-btn.active{background:linear-gradient(135deg,#FFD700,#FFEC8B);color:#000;}
        .history-list{display:flex;flex-direction:column;gap:1rem;}
        .history-item{background:rgba(255,255,255,0.8);backdrop-filter:blur(10px);border:1px solid rgba(0,0,0,0.05);border-radius:12px;padding:1rem;font-size:0.9rem;color:#000;box-shadow:0 2px 10px rgba(0,0,0,0.05);cursor:pointer;}
        .footer{width:100%;max-width:1400px;padding:2rem;text-align:center;margin-top:2rem;background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(240,240,240,0.9));backdrop-filter:blur(20px);border-radius:16px;}
        .footer p{color:rgba(0,0,0,0.6);font-size:0.9rem;margin-bottom:1rem;}
        .social-links{display:flex;justify-content:center;gap:1.2rem;padding-top:0;}
        .social-link{font-size:1.5rem;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);border:1px solid rgba(0,0,0,0.05);color:#000;filter:grayscale(100%) opacity(0.7);transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 4px 12px rgba(0,0,0,0.1);}
        .social-link:hover{filter:grayscale(0%) opacity(1);transform:scale(1.1) rotate(5deg);box-shadow:0 8px 20px rgba(0,0,0,0.15);}
        .social-link.x:hover{background:linear-gradient(135deg,#1DA1F2,#1877F2);color:#fff;border-color:rgba(29,161,242,0.3);}
        .social-link.instagram:hover{background:linear-gradient(135deg,#C13584,#F77737);color:#fff;border-color:rgba(193,53,132,0.3);}
        .auto-detect-indicator{display:inline-block;margin-left:0.5rem;color:#4CAF50;font-size:0.8rem;}
        @keyframes fadeInDown{from{opacity:0;transform:translateY(-20px);}to{opacity:1;transform:translateY(0);}}
        @keyframes slideInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
        @keyframes dropdownFade{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);}}
        @keyframes spin{to{transform:rotate(360deg);}}
        @media (max-width:768px){
            .container{padding:1rem;}
            .translation-container{grid-template-columns:1fr;}
            .translation-container::before{display:none;}
            .language-bar{flex-direction:column;gap:1rem;}
            .language-selector{width:100%;}
            .swap-btn{margin:1rem 0;}
            .affiliate-ads{grid-template-columns:1fr;}
            .logo h1{font-size:2rem;}
            .logo span{font-size:1rem;}
            .social-link{width:36px;height:36px;font-size:1.3rem;}
            .social-links{gap:1rem;}
            .ad-text h3{font-size:1.1rem;}
            .ad-text p{font-size:0.85rem;}
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header" role="banner">
            <div class="logo">
                <h1>NEXO</h1>
                <span>TRANSLATOR</span>
            </div>
        </header>

        <main class="main-container" role="main" aria-label="Translation Interface">
            <div class="language-bar">
                <div class="language-selector">
                    <button class="language-btn" id="source-lang-btn" aria-haspopup="listbox" aria-label="Select source language">
                        <span>Auto Detect</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="language-dropdown" id="source-lang-dropdown" role="listbox">
                        <div class="language-option" data-lang="auto" role="option">Auto Detect</div>
                        <div class="language-option" data-lang="en" role="option">English</div>
                        <div class="language-option" data-lang="es" role="option">Spanish</div>
                        <div class="language-option" data-lang="fr" role="option">French</div>
                        <div class="language-option" data-lang="de" role="option">German</div>
                        <div class="language-option" data-lang="it" role="option">Italian</div>
                        <div class="language-option" data-lang="pt" role="option">Portuguese</div>
                        <div class="language-option" data-lang="ru" role="option">Russian</div>
                        <div class="language-option" data-lang="zh" role="option">Chinese (Simplified)</div>
                        <div class="language-option" data-lang="ja" role="option">Japanese</div>
                        <div class="language-option" data-lang="ko" role="option">Korean</div>
                        <div class="language-option" data-lang="ar" role="option">Arabic</div>
                        <div class="language-option" data-lang="nl" role="option">Dutch</div>
                        <div class="language-option" data-lang="sv" role="option">Swedish</div>
                        <div class="language-option" data-lang="no" role="option">Norwegian</div>
                        <div class="language-option" data-lang="da" role="option">Danish</div>
                        <div class="language-option" data-lang="fi" role="option">Finnish</div>
                        <div class="language-option" data-lang="pl" role="option">Polish</div>
                        <div class="language-option" data-lang="tr" role="option">Turkish</div>
                        <div class="language-option" data-lang="hi" role="option">Hindi</div>
                        <div class="language-option" data-lang="bn" role="option">Bengali</div>
                        <div class="language-option" data-lang="th" role="option">Thai</div>
                        <div class="language-option" data-lang="vi" role="option">Vietnamese</div>
                        <div class="language-option" data-lang="id" role="option">Indonesian</div>
                        <div class="language-option" data-lang="ms" role="option">Malay</div>
                        <div class="language-option" data-lang="el" role="option">Greek</div>
                        <div class="language-option" data-lang="he" role="option">Hebrew</div>
                        <div class="language-option" data-lang="cs" role="option">Czech</div>
                        <div class="language-option" data-lang="sk" role="option">Slovak</div>
                        <div class="language-option" data-lang="hu" role="option">Hungarian</div>
                        <div class="language-option" data-lang="ro" role="option">Romanian</div>
                        <div class="language-option" data-lang="bg" role="option">Bulgarian</div>
                        <div class="language-option" data-lang="uk" role="option">Ukrainian</div>
                        <div class="language-option" data-lang="hr" role="option">Croatian</div>
                        <div class="language-option" data-lang="sr" role="option">Serbian</div>
                        <div class="language-option" data-lang="sl" role="option">Slovenian</div>
                        <div class="language-option" data-lang="lt" role="option">Lithuanian</div>
                        <div class="language-option" data-lang="lv" role="option">Latvian</div>
                        <div class="language-option" data-lang="et" role="option">Estonian</div>
                        <div class="language-option" data-lang="fa" role="option">Persian</div>
                        <div class="language-option" data-lang="sw" role="option">Swahili</div>
                        <div class="language-option" data-lang="am" role="option">Amharic</div>
                        <div class="language-option" data-lang="zu" role="option">Zulu</div>
                        <div class="language-option" data-lang="xh" role="option">Xhosa</div>
                        <div class="language-option" data-lang="so" role="option">Somali</div>
                        <div class="language-option" data-lang="ta" role="option">Tamil</div>
                        <div class="language-option" data-lang="te" role="option">Telugu</div>
                        <div class="language-option" data-lang="ml" role="option">Malayalam</div>
                        <div class="language-option" data-lang="kn" role="option">Kannada</div>
                        <div class="language-option" data-lang="gu" role="option">Gujarati</div>
                        <div class="language-option" data-lang="pa" role="option">Punjabi</div>
                        <div class="language-option" data-lang="ha" role="option">Hausa</div>
                        <div class="language-option" data-lang="yo" role="option">Yoruba</div>
                        <div class="language-option" data-lang="ig" role="option">Igbo</div>
                    </div>
                </div>
                <button class="swap-btn" id="swap-btn" aria-label="Swap languages">
                    <i class="fas fa-exchange-alt"></i>
                </button>
                <div class="language-selector">
                    <button class="language-btn" id="target-lang-btn" aria-haspopup="listbox" aria-label="Select target language">
                        <span>English</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="language-dropdown" id="target-lang-dropdown" role="listbox">
                        <div class="language-option" data-lang="en" role="option">English</div>
                        <div class="language-option" data-lang="es" role="option">Spanish</div>
                        <div class="language-option" data-lang="fr" role="option">French</div>
                        <div class="language-option" data-lang="de" role="option">German</div>
                        <div class="language-option" data-lang="it" role="option">Italian</div>
                        <div class="language-option" data-lang="pt" role="option">Portuguese</div>
                        <div class="language-option" data-lang="ru" role="option">Russian</div>
                        <div class="language-option" data-lang="zh" role="option">Chinese (Simplified)</div>
                        <div class="language-option" data-lang="ja" role="option">Japanese</div>
                        <div class="language-option" data-lang="ko" role="option">Korean</div>
                        <div class="language-option" data-lang="ar" role="option">Arabic</div>
                        <div class="language-option" data-lang="nl" role="option">Dutch</div>
                        <div class="language-option" data-lang="sv" role="option">Swedish</div>
                        <div class="language-option" data-lang="no" role="option">Norwegian</div>
                        <div class="language-option" data-lang="da" role="option">Danish</div>
                        <div class="language-option" data-lang="fi" role="option">Finnish</div>
                        <div class="language-option" data-lang="pl" role="option">Polish</div>
                        <div class="language-option" data-lang="tr" role="option">Turkish</div>
                        <div class="language-option" data-lang="hi" role="option">Hindi</div>
                        <div class="language-option" data-lang="bn" role="option">Bengali</div>
                        <div class="language-option" data-lang="th" role="option">Thai</div>
                        <div class="language-option" data-lang="vi" role="option">Vietnamese</div>
                        <div class="language-option" data-lang="id" role="option">Indonesian</div>
                        <div class="language-option" data-lang="ms" role="option">Malay</div>
                        <div class="language-option" data-lang="el" role="option">Greek</div>
                        <div class="language-option" data-lang="he" role="option">Hebrew</div>
                        <div class="language-option" data-lang="cs" role="option">Czech</div>
                        <div class="language-option" data-lang="sk" role="option">Slovak</div>
                        <div class="language-option" data-lang="hu" role="option">Hungarian</div>
                        <div class="language-option" data-lang="ro" role="option">Romanian</div>
                        <div class="language-option" data-lang="bg" role="option">Bulgarian</div>
                        <div class="language-option" data-lang="uk" role="option">Ukrainian</div>
                        <div class="language-option" data-lang="hr" role="option">Croatian</div>
                        <div class="language-option" data-lang="sr" role="option">Serbian</div>
                        <div class="language-option" data-lang="sl" role="option">Slovenian</div>
                        <div class="language-option" data-lang="lt" role="option">Lithuanian</div>
                        <div class="language-option" data-lang="lv" role="option">Latvian</div>
                        <div class="language-option" data-lang="et" role="option">Estonian</div>
                        <div class="language-option" data-lang="fa" role="option">Persian</div>
                        <div class="language-option" data-lang="sw" role="option">Swahili</div>
                        <div class="language-option" data-lang="am" role="option">Amharic</div>
                        <div class="language-option" data-lang="zu" role="option">Zulu</div>
                        <div class="language-option" data-lang="xh" role="option">Xhosa</div>
                        <div class="language-option" data-lang="so" role="option">Somali</div>
                        <div class="language-option" data-lang="ta" role="option">Tamil</div>
                        <div class="language-option" data-lang="te" role="option">Telugu</div>
                        <div class="language-option" data-lang="ml" role="option">Malayalam</div>
                        <div class="language-option" data-lang="kn" role="option">Kannada</div>
                        <div class="language-option" data-lang="gu" role="option">Gujarati</div>
                        <div class="language-option" data-lang="pa" role="option">Punjabi</div>
                        <div class="language-option" data-lang="ha" role="option">Hausa</div>
                        <div class="language-option" data-lang="yo" role="option">Yoruba</div>
                        <div class="language-option" data-lang="ig" role="option">Igbo</div>
                    </div>
                </div>
            </div>
            <div class="translation-container">
                <div class="text-panel">
                    <textarea class="text-area" id="source-text" placeholder="Enter text or speak to translate..." maxlength="5000" aria-label="Source text input"></textarea>
                    <div class="char-count" id="char-count">0/5000</div>
                    <div class="panel-controls">
                        <button class="control-btn mic-btn" id="mic-btn" title="Voice Input" aria-label="Start voice input">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="control-btn" id="copy-source-btn" title="Copy Text" aria-label="Copy source text">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="control-btn" id="speak-source-btn" title="Speak Text" aria-label="Speak source text">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                <div class="text-panel">
                    <textarea class="text-area" id="translated-text" placeholder="Translation appears here..." readonly aria-label="Translated text output"></textarea>
                    <div class="panel-controls">
                        <button class="control-btn" id="copy-translated-btn" title="Copy Translation" aria-label="Copy translated text">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="control-btn" id="speak-translated-btn" title="Speak Translation" aria-label="Speak translated text">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="bottom-bar">
                <span class="detect-language" id="detected-language" aria-live="polite">Ready to translate</span>
                <button class="translate-btn" id="translate-btn" aria-label="Translate text">Translate</button>
            </div>
            <div class="error-message" id="error-message" role="alert"></div>
        </main>

        <section class="affiliate-ads" aria-label="Affiliate Advertisements">
            <a href="https://rzekl.com/g/pm1aev55clb63cb1a621219aa26f6f/" class="affiliate-ad alibaba-ad" target="_blank" rel="sponsored">
                <div class="ad-content">
                    <div class="ad-text">
                        <h3>Shop Global Deals on Alibaba</h3>
                        <p>Discover millions of products from trusted suppliers worldwide with unbeatable prices and fast shipping.</p>
                    </div>
                </div>
            </a>
            <a href="https://plrvq.com/g/gp8po8i1u7b63cb1a62145d8e108c6/" class="affiliate-ad retouchme-ad" target="_blank" rel="sponsored">
                <div class="ad-content">
                    <div class="ad-text">
                        <h3>Enhance Photos with Retouch4Me</h3>
                        <p>Transform your images with AI-powered editing tools for professional-quality results in seconds.</p>
                    </div>
                </div>
            </a>
        </section>

        <section class="history-section" aria-label="Translation History">
            <div class="history-header">
                <h2>Translation History</h2>
                <button class="clear-history-btn" id="clear-history-btn" aria-label="Clear translation history">Clear History</button>
            </div>
            <div class="history-list" id="history-list"></div>
        </section>

        <footer class="footer" role="contentinfo">
            <p>&copy; Nexo Translator. All rights reserved.</p>
            <div class="social-links">
                <a href="https://x.com/nexotranslator" class="social-link x" target="_blank" title="Follow us on X" aria-label="Follow Nexo Translator on X">
                    <i class="fab fa-x-twitter"></i>
                </a>
                <a href="https://instagram.com/nexotranslator" class="social-link instagram" target="_blank" title="Follow us on Instagram" aria-label="Follow Nexo Translator on Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </footer>
    </div>

    <script>
        class NexoTranslator {
            constructor() {
                this.languageMap = {
                    'en': { code: 'en', display: 'English', deeplCode: 'en', speechCode: 'en-US' },
                    'es': { code: 'es', display: 'Spanish', deeplCode: 'es', speechCode: 'es-ES' },
                    'fr': { code: 'fr', display: 'French', deeplCode: 'fr', speechCode: 'fr-FR' },
                    'de': { code: 'de', display: 'German', deeplCode: 'de', speechCode: 'de-DE' },
                    'it': { code: 'it', display: 'Italian', deeplCode: 'it', speechCode: 'it-IT' },
                    'pt': { code: 'pt', display: 'Portuguese', deeplCode: 'pt-pt', speechCode: 'pt-PT' },
                    'ru': { code: 'ru', display: 'Russian', deeplCode: 'ru', speechCode: 'ru-RU' },
                    'zh': { code: 'zh', display: 'Chinese', deeplCode: 'zh', speechCode: 'zh-CN' },
                    'ja': { code: 'ja', display: 'Japanese', deeplCode: 'ja', speechCode: 'ja-JP' },
                    'ko': { code: 'ko', display: 'Korean', speechCode: 'ko-KR' },
                    'ar': { code: 'ar', display: 'Arabic', speechCode: 'ar-SA' },
                    'nl': { code: 'nl', display: 'Dutch', deeplCode: 'nl', speechCode: 'nl-NL' },
                    'sv': { code: 'sv', display: 'Swedish', deeplCode: 'sv', speechCode: 'sv-SE' },
                    'no': { code: 'no', display: 'Norwegian', deeplCode: 'nb', speechCode: 'no-NO' },
                    'da': { code: 'da', display: 'Danish', deeplCode: 'da', speechCode: 'da-DK' },
                    'fi': { code: 'fi', display: 'Finnish', deeplCode: 'fi', speechCode: 'fi-FI' },
                    'pl': { code: 'pl', display: 'Polish', deeplCode: 'pl', speechCode: 'pl-PL' },
                    'tr': { code: 'tr', display: 'Turkish', deeplCode: 'tr', speechCode: 'tr-TR' },
                    'hi': { code: 'hi', display: 'Hindi', speechCode: 'hi-IN' },
                    'bn': { code: 'bn', display: 'Bengali', speechCode: 'bn-IN' },
                    'th': { code: 'th', display: 'Thai', speechCode: 'th-TH' },
                    'vi': { code: 'vi', display: 'Vietnamese', speechCode: 'vi-VN' },
                    'id': { code: 'id', display: 'Indonesian', speechCode: 'id-ID' },
                    'ms': { code: 'ms', display: 'Malay', speechCode: 'ms-MY' },
                    'el': { code: 'el', display: 'Greek', deeplCode: 'el', speechCode: 'el-GR' },
                    'he': { code: 'he', display: 'Hebrew', speechCode: 'he-IL' },
                    'cs': { code: 'cs', display: 'Czech', deeplCode: 'cs', speechCode: 'cs-CZ' },
                    'sk': { code: 'sk', display: 'Slovak', deeplCode: 'sk', speechCode: 'sk-SK' },
                    'hu': { code: 'hu', display: 'Hungarian', deeplCode: 'hu', speechCode: 'hu-HU' },
                    'ro': { code: 'ro', display: 'Romanian', deeplCode: 'ro', speechCode: 'ro-RO' },
                    'bg': { code: 'bg', display: 'Bulgarian', deeplCode: 'bg', speechCode: 'bg-BG' },
                    'uk': { code: 'uk', display: 'Ukrainian', deeplCode: 'uk', speechCode: 'uk-UA' },
                    'hr': { code: 'hr', display: 'Croatian', speechCode: 'hr-HR' },
                    'sr': { code: 'sr', display: 'Serbian', speechCode: 'sr-RS' },
                    'sl': { code: 'sl', display: 'Slovenian', deeplCode: 'sl', speechCode: 'sl-SI' },
                    'lt': { code: 'lt', display: 'Lithuanian', deeplCode: 'lt', speechCode: 'lt-LT' },
                    'lv': { code: 'lv', display: 'Latvian', deeplCode: 'lv', speechCode: 'lv-LV' },
                    'et': { code: 'et', display: 'Estonian', deeplCode: 'et', speechCode: 'et-EE' },
                    'fa': { code: 'fa', display: 'Persian', speechCode: 'fa-IR' },
                    'sw': { code: 'sw', display: 'Swahili', speechCode: 'sw-KE' },
                    'am': { code: 'am', display: 'Amharic', speechCode: 'am-ET' },
                    'zu': { code: 'zu', display: 'Zulu', speechCode: 'zu-ZA' },
                    'xh': { code: 'xh', display: 'Xhosa', speechCode: 'xh-ZA' },
                    'so': { code: 'so', display: 'Somali', speechCode: 'so-SO' },
                    'ta': { code: 'ta', display: 'Tamil', speechCode: 'ta-IN' },
                    'te': { code: 'te', display: 'Telugu', speechCode: 'te-IN' },
                    'ml': { code: 'ml', display: 'Malayalam', speechCode: 'ml-IN' },
                    'kn': { code: 'kn', display: 'Kannada', speechCode: 'kn-IN' },
                    'gu': { code: 'gu', display: 'Gujarati', speechCode: 'gu-IN' },
                    'pa': { code: 'pa', display: 'Punjabi', speechCode: 'pa-IN' },
                    'ha': { code: 'ha', display: 'Hausa', speechCode: 'ha-NG' },
                    'yo': { code: 'yo', display: 'Yoruba', speechCode: 'yo-NG' },
                    'ig': { code: 'ig', display: 'Igbo', speechCode: 'ig-NG' }
                };
                this.translationCache = this.loadTranslationCache();
                this.translationHistory = this.loadHistory();
                this.favoriteTranslations = this.loadFavorites();
                this.sourceLang = 'auto';
                this.targetLang = 'en';
                this.recognition = null;
                this.initializeElements();
                this.setupEventListeners();
                this.setupSpeechRecognition();
                this.renderHistory();
            }

            initializeElements() {
                this.elements = {
                    sourceLangBtn: document.getElementById('source-lang-btn'),
                    targetLangBtn: document.getElementById('target-lang-btn'),
                    sourceLangDropdown: document.getElementById('source-lang-dropdown'),
                    targetLangDropdown: document.getElementById('target-lang-dropdown'),
                    sourceText: document.getElementById('source-text'),
                    translatedText: document.getElementById('translated-text'),
                    charCount: document.getElementById('char-count'),
                    translateBtn: document.getElementById('translate-btn'),
                    swapBtn: document.getElementById('swap-btn'),
                    micBtn: document.getElementById('mic-btn'),
                    copySourceBtn: document.getElementById('copy-source-btn'),
                    copyTranslatedBtn: document.getElementById('copy-translated-btn'),
                    speakSourceBtn: document.getElementById('speak-source-btn'),
                    speakTranslatedBtn: document.getElementById('speak-translated-btn'),
                    detectedLanguage: document.getElementById('detected-language'),
                    historyList: document.getElementById('history-list'),
                    clearHistoryBtn: document.getElementById('clear-history-btn'),
                    errorMessage: document.getElementById('error-message')
                };
            }

            setupEventListeners() {
                this.elements.sourceLangBtn.addEventListener('click', () => this.toggleDropdown(this.elements.sourceLangDropdown, this.elements.sourceLangBtn));
                this.elements.targetLangBtn.addEventListener('click', () => this.toggleDropdown(this.elements.targetLangDropdown, this.elements.targetLangBtn));
                this.elements.sourceLangDropdown.addEventListener('click', (e) => {
                    if (e.target.classList.contains('language-option')) {
                        this.sourceLang = e.target.dataset.lang;
                        this.elements.sourceLangBtn.querySelector('span').textContent = e.target.textContent;
                        this.elements.sourceLangDropdown.classList.remove('active');
                        this.updateTranslateButton();
                    }
                });
                this.elements.targetLangDropdown.addEventListener('click', (e) => {
                    if (e.target.classList.contains('language-option')) {
                        this.targetLang = e.target.dataset.lang;
                        this.elements.targetLangBtn.querySelector('span').textContent = e.target.textContent;
                        this.elements.targetLangDropdown.classList.remove('active');
                        this.updateTranslateButton();
                    }
                });
                this.elements.sourceText.addEventListener('input', () => {
                    this.elements.charCount.textContent = `${this.elements.sourceText.value.length}/5000`;
                    this.updateTranslateButton();
                    if (this.sourceLang === 'auto' && this.elements.sourceText.value.trim().length > 10) {
                        this.debounceAutoTranslate();
                    }
                });
                this.elements.swapBtn.addEventListener('click', () => this.swapLanguages());
                this.elements.translateBtn.addEventListener('click', () => this.translateText());
                this.elements.copySourceBtn.addEventListener('click', () => this.copyToClipboard(this.elements.sourceText.value));
                this.elements.copyTranslatedBtn.addEventListener('click', () => this.copyToClipboard(this.elements.translatedText.value));
                this.elements.speakSourceBtn.addEventListener('click', () => this.speakText(this.elements.sourceText.value, this.sourceLang));
                this.elements.speakTranslatedBtn.addEventListener('click', () => this.speakText(this.elements.translatedText.value, this.targetLang));
                this.elements.clearHistoryBtn.addEventListener('click', () => this.clearHistory());
                this.elements.micBtn?.addEventListener('click', () => this.toggleVoiceInput());
                this.elements.sourceLangBtn.addEventListener('keydown', (e) => this.handleKeyboardNavigation(e, this.elements.sourceLangDropdown));
                this.elements.targetLangBtn.addEventListener('keydown', (e) => this.handleKeyboardNavigation(e, this.elements.targetLangDropdown));
            }

            handleKeyboardNavigation(event, dropdown) {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    this.toggleDropdown(dropdown, event.target);
                }
                if (event.key === 'ArrowDown' && dropdown.classList.contains('active')) {
                    event.preventDefault();
                    dropdown.querySelector('.language-option').focus();
                }
            }

            debounceAutoTranslate() {
                clearTimeout(this.autoTranslateTimer);
                this.autoTranslateTimer = setTimeout(() => {
                    if (this.elements.sourceText.value.trim()) {
                        this.translateText(true);
                    }
                }, 1500); // Increased debounce time to reduce API calls
            }

            async detectLanguage(text) {
                if (!text.trim()) return 'en';
                const cacheKey = `detect:${text}`;
                const cachedLang = this.translationCache.get(cacheKey);
                if (cachedLang) return cachedLang;
                const scriptPatterns = {
                    'ar': { pattern: /[\u0600-\u06FF]/, threshold: 0.3 },
                    'zh': { pattern: /[\u4e00-\u9fff]/, threshold: 0.2 },
                    'ja': { pattern: /[\u3040-\u30ff]/, threshold: 0.15 },
                    'ko': { pattern: /[\uac00-\ud7af]/, threshold: 0.2 },
                    'hi': { pattern: /[\u0900-\u097f]/, threshold: 0.2 }
                };
                for (const [lang, {pattern, threshold}] of Object.entries(scriptPatterns)) {
                    const matches = text.match(pattern);
                    if (matches && matches.length / text.length > threshold) {
                        this.translationCache.set(cacheKey, lang);
                        this.saveTranslationCache();
                        return lang;
                    }
                }
                const words = text.toLowerCase().match(/\b[\w\u0080-\uFFFF]+\b/g) || [];
                const languageWords = {
                    'en': ['the', 'and', 'that', 'have', 'for'],
                    'es': ['que', 'de', 'no', 'se', 'la'],
                    'fr': ['le', 'de', 'et', 'à', 'un'],
                    'de': ['der', 'die', 'und', 'in', 'den'],
                    'ha': ['na', 'da', 'shi', 'ya', 'ba'],
                    'yo': ['ni', 'ti', 'si', 'bi', 'ki'],
                    'ig': ['na', 'nke', 'ya', 'ka', 'si']
                };
                let bestLang = 'en';
                let maxScore = 0;
                for (const [lang, wordList] of Object.entries(languageWords)) {
                    const matches = words.filter(word => wordList.includes(word)).length;
                    const score = words.length > 0 ? matches / words.length : 0;
                    if (score > maxScore && score > 0.05) {
                        maxScore = score;
                        bestLang = lang;
                    }
                }
                this.translationCache.set(cacheKey, bestLang);
                this.saveTranslationCache();
                return bestLang;
            }

            async translateText(isAuto = false) {
                const text = this.elements.sourceText.value.trim();
                if (!text) return;
                this.hideError();
                if (!isAuto) {
                    this.elements.translateBtn.disabled = true;
                    this.elements.translateBtn.innerHTML = '<span class="spinner"></span> Translating...';
                }
                try {
                    let detectedLang = this.sourceLang;
                    if (this.sourceLang === 'auto') {
                        detectedLang = await this.detectLanguage(text);
                        this.elements.detectedLanguage.innerHTML = `Detected: ${this.languageMap[detectedLang]?.display || detectedLang.toUpperCase()} <span class="auto-detect-indicator">●</span>`;
                    }
                    if (detectedLang === this.targetLang) {
                        throw new Error('Source and target languages are the same. Please select different languages.');
                    }
                    const cacheKey = `${text}:${detectedLang}:${this.targetLang}`;
                    const cachedTranslation = this.translationCache.get(cacheKey);
                    if (cachedTranslation) {
                        this.elements.translatedText.value = cachedTranslation;
                        if (!isAuto) {
                            this.addToHistory({ source: text, target: cachedTranslation, sourceLang: detectedLang, targetLang: this.targetLang, timestamp: new Date().toISOString(), isFavorite: false });
                        }
                        return;
                    }
                    const translation = await this.performTranslation(text, detectedLang, this.targetLang);
                    this.translationCache.set(cacheKey, translation);
                    this.saveTranslationCache();
                    this.elements.translatedText.value = translation;
                    if (!isAuto) {
                        this.addToHistory({ source: text, target: translation, sourceLang: detectedLang, targetLang: this.targetLang, timestamp: new Date().toISOString(), isFavorite: false });
                    }
                } catch (error) {
                    this.showError(error.message);
                    this.elements.translatedText.value = '';
                } finally {
                    if (!isAuto) {
                        this.elements.translateBtn.innerHTML = 'Translate';
                        this.elements.translateBtn.disabled = false;
                    }
                }
            }

            async performTranslation(text, sourceLang, targetLang) {
                const translationMethods = [
                    async () => {
                        const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${sourceLang}|${targetLang}&de=nexotranslator@example.com`;
                        const response = await fetch(url, { signal: AbortSignal.timeout(5000) });
                        const data = await response.json();
                        if (data.responseData && data.responseData.translatedText && !data.responseData.translatedText.toLowerCase().includes('quota exceeded')) {
                            return data.responseData.translatedText;
                        }
                        throw new Error('MyMemory service unavailable');
                    },
                    async () => {
                        const response = await fetch('https://libretranslate.de/translate', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ q: text, source: sourceLang, target: targetLang, format: 'text' }),
                            signal: AbortSignal.timeout(5000)
                        });
                        const data = await response.json();
                        if (data.error) throw new Error(data.error);
                        return data.translatedText;
                    },
                    async () => {
                        const basicDict = this.getBasicTranslation(text, sourceLang, targetLang);
                        if (basicDict !== text) return basicDict;
                        throw new Error('No translation available');
                    }
                ];
                try {
                    const result = await Promise.any(translationMethods.map(method => method()));
                    if (result && result.trim() && result !== text) {
                        return result.trim();
                    }
                    throw new Error('No valid translation received');
                } catch (error) {
                    throw new Error('All translation services are currently unavailable. Please try again later.');
                }
            }

            getBasicTranslation(text, sourceLang, targetLang) {
                const basicTranslations = {
                    'es': { 'hola': 'hello', 'gracias': 'thank you', 'sí': 'yes', 'no': 'no', 'por favor': 'please' },
                    'fr': { 'bonjour': 'hello', 'merci': 'thank you', 'oui': 'yes', 'non': 'no', 's\'il vous plaît': 'please' },
                    'de': { 'hallo': 'hello', 'danke': 'thank you', 'ja': 'yes', 'nein': 'no', 'bitte': 'please' },
                    'ha': { 'sannu': 'hello', 'na gode': 'thank you', 'eh': 'yes', 'a\'a': 'no', 'don allah': 'please' },
                    'yo': { 'bawo': 'hello', 'e se': 'thank you', 'beeni': 'yes', 'rara': 'no', 'je ka': 'please' },
                    'ig': { 'nno': 'hello', 'dalu': 'thank you', 'ee': 'yes', 'mba': 'no', 'biko': 'please' }
                };
                const lowerText = text.toLowerCase().trim();
                if (basicTranslations[sourceLang]?.[lowerText]) {
                    return basicTranslations[sourceLang][lowerText];
                }
                for (const [lang, translations] of Object.entries(basicTranslations)) {
                    for (const [foreign, english] of Object.entries(translations)) {
                        if (english.toLowerCase() === lowerText && targetLang === lang) {
                            return foreign;
                        }
                    }
                }
                return text;
            }

            toggleDropdown(dropdown, button) {
                dropdown.classList.toggle('active');
                const closeDropdown = (e) => {
                    if (!button.contains(e.target) && !dropdown.contains(e.target)) {
                        dropdown.classList.remove('active');
                        document.removeEventListener('click', closeDropdown);
                    }
                };
                setTimeout(() => document.addEventListener('click', closeDropdown), 0);
            }

            updateTranslateButton() {
                const hasText = this.elements.sourceText.value.trim().length > 0;
                const differentLangs = this.sourceLang !== this.targetLang;
                this.elements.translateBtn.classList.toggle('visible', hasText && differentLangs);
                this.elements.translateBtn.disabled = !(hasText && differentLangs);
            }

            swapLanguages() {
                if (this.sourceLang === 'auto') return;
                [this.sourceLang, this.targetLang] = [this.targetLang, this.sourceLang];
                [this.elements.sourceText.value, this.elements.translatedText.value] = [this.elements.translatedText.value, this.elements.sourceText.value];
                this.elements.sourceLangBtn.querySelector('span').textContent = this.languageMap[this.sourceLang]?.display || this.sourceLang;
                this.elements.targetLangBtn.querySelector('span').textContent = this.languageMap[this.targetLang]?.display || this.targetLang;
                this.elements.charCount.textContent = `${this.elements.sourceText.value.length}/5000`;
                this.updateTranslateButton();
            }

            setupSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = false;
                    this.recognition.interimResults = false;
                    this.recognition.lang = 'en-US';
                    this.recognition.onstart = () => {
                        this.elements.micBtn.classList.add('recording');
                        this.showSuccess('Listening... Speak now.');
                    };
                    this.recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        this.elements.sourceText.value += (this.elements.sourceText.value ? ' ' : '') + transcript;
                        this.elements.charCount.textContent = `${this.elements.sourceText.value.length}/5000`;
                        this.updateTranslateButton();
                        this.elements.micBtn.classList.remove('recording');
                        this.showSuccess('Speech captured successfully!');
                        if (this.sourceLang === 'auto' && this.elements.sourceText.value.trim().length > 10) {
                            this.debounceAutoTranslate();
                        }
                    };
                    this.recognition.onerror = (event) => {
                        this.elements.micBtn.classList.remove('recording');
                        let errorMessage = 'Speech recognition failed. Please try again.';
                        if (event.error === 'no-speech') {
                            errorMessage = 'No speech detected. Please speak clearly.';
                        } else if (event.error === 'not-allowed') {
                            errorMessage = 'Microphone access denied. Please enable microphone permissions in your browser settings.';
                        } else if (event.error === 'service-not-allowed') {
                            errorMessage = 'Speech recognition service is not available. Please try again later.';
                        }
                        this.showError(errorMessage);
                    };
                    this.recognition.onend = () => {
                        this.elements.micBtn.classList.remove('recording');
                    };
                    navigator.permissions.query({ name: 'microphone' }).then((result) => {
                        if (result.state === 'denied') {
                            this.showError('Microphone access is denied. Please enable it in your browser settings.');
                            this.elements.micBtn.style.display = 'none';
                        }
                    }).catch(() => {});
                } else {
                    this.elements.micBtn.style.display = 'none';
                    this.showError('Speech recognition is not supported in your browser.');
                }
            }

            toggleVoiceInput() {
                if (!this.recognition) {
                    this.showError('Speech recognition is not available.');
                    return;
                }
                if (this.elements.micBtn.classList.contains('recording')) {
                    this.recognition.stop();
                } else {
                    const langCode = this.sourceLang === 'auto' ? 'en-US' : this.languageMap[this.sourceLang]?.speechCode || 'en-US';
                    this.recognition.lang = langCode;
                    try {
                        this.recognition.start();
                    } catch (error) {
                        this.showError('Failed to start speech recognition. Please check microphone permissions.');
                    }
                }
            }

            copyToClipboard(text) {
                if (!text.trim()) {
                    this.showError('No text to copy');
                    return;
                }
                navigator.clipboard.writeText(text).then(() => {
                    this.showSuccess('Copied to clipboard!');
                }).catch(() => {
                    this.showError('Failed to copy text');
                });
            }

            speakText(text, language) {
                if (!text.trim()) {
                    this.showError('No text to speak');
                    return;
                }
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = this.languageMap[language]?.speechCode || (language === 'auto' ? 'en-US' : language);
                    utterance.rate = 0.9;
                    utterance.pitch = 1;
                    window.speechSynthesis.speak(utterance);
                } else {
                    this.showError('Text-to-speech not supported in your browser');
                }
            }

            addToHistory(item) {
                this.translationHistory.unshift(item);
                if (this.translationHistory.length > 20) {
                    this.translationHistory = this.translationHistory.slice(0, 20);
                }
                this.saveHistory();
                this.renderHistory();
            }

            toggleFavorite(index) {
                this.translationHistory[index].isFavorite = !this.translationHistory[index].isFavorite;
                if (this.translationHistory[index].isFavorite) {
                    this.favoriteTranslations.push(this.translationHistory[index]);
                } else {
                    this.favoriteTranslations = this.favoriteTranslations.filter(fav => fav.timestamp !== this.translationHistory[index].timestamp);
                }
                this.saveHistory();
                this.saveFavorites();
                this.renderHistory();
            }

            renderHistory() {
                if (this.translationHistory.length === 0) {
                    this.elements.historyList.innerHTML = '<div class="history-item" role="button" aria-label="No translation history">No translation history yet. Start translating to see your history here!</div>';
                    return;
                }
                this.elements.historyList.innerHTML = this.translationHistory.map((item, index) => `
                    <div class="history-item" role="button" aria-label="View translation from ${this.languageMap[item.sourceLang]?.display || item.sourceLang} to ${this.languageMap[item.targetLang]?.display || item.targetLang}" onclick="nexoTranslator.loadHistoryItem(${index})">
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0.5rem;">
                            <strong>${this.languageMap[item.sourceLang]?.display || item.sourceLang.toUpperCase()} → ${this.languageMap[item.targetLang]?.display || item.targetLang.toUpperCase()}</strong>
                            <div>
                                <button class="favorite-btn ${item.isFavorite ? 'active' : ''}" onclick="nexoTranslator.toggleFavorite(${index});event.stopPropagation();" aria-label="${item.isFavorite ? 'Remove from favorites' : 'Add to favorites'}">
                                    <i class="fas fa-star"></i>
                                </button>
                                <small style="color:rgba(0,0,0,0.5);">${new Date(item.timestamp).toLocaleString()}</small>
                            </div>
                        </div>
                        <div style="margin-bottom:0.5rem;color:rgba(0,0,0,0.7);">${item.source}</div>
                        <div style="color:rgba(0,0,0,0.9);font-weight:500;">${item.target}</div>
                    </div>
                `).join('');
            }

            loadHistoryItem(index) {
                const item = this.translationHistory[index];
                if (!item) return;
                this.elements.sourceText.value = item.source;
                this.elements.translatedText.value = item.target;
                this.sourceLang = item.sourceLang;
                this.targetLang = item.targetLang;
                this.elements.sourceLangBtn.querySelector('span').textContent = this.languageMap[item.sourceLang]?.display || item.sourceLang.toUpperCase();
                this.elements.targetLangBtn.querySelector('span').textContent = this.languageMap[item.targetLang]?.display || this.targetLang.toUpperCase();
                this.elements.charCount.textContent = `${this.elements.sourceText.value.length}/5000`;
                this.updateTranslateButton();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            clearHistory() {
                if (confirm('Are you sure you want to clear all translation history?')) {
                    this.translationHistory = [];
                    this.favoriteTranslations = [];
                    this.saveHistory();
                    this.saveFavorites();
                    this.renderHistory();
                    this.showSuccess('History cleared successfully!');
                }
            }

            loadTranslationCache() {
                try {
                    const stored = localStorage.getItem('nexo_translation_cache');
                    return stored ? new Map(JSON.parse(stored)) : new Map();
                } catch (error) {
                    return new Map();
                }
            }

            saveTranslationCache() {
                try {
                    const serialized = JSON.stringify([...this.translationCache]);
                    localStorage.setItem('nexo_translation_cache', serialized);
                } catch (error) {}
            }

            loadHistory() {
                try {
                    const stored = localStorage.getItem('nexo_translation_history');
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    return [];
                }
            }

            saveHistory() {
                try {
                    localStorage.setItem('nexo_translation_history', JSON.stringify(this.translationHistory));
                } catch (error) {}
            }

            loadFavorites() {
                try {
                    const stored = localStorage.getItem('nexo_favorite_translations');
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    return [];
                }
            }

            saveFavorites() {
                try {
                    localStorage.setItem('nexo_favorite_translations', JSON.stringify(this.favoriteTranslations));
                } catch (error) {}
            }

            showError(message) {
                this.elements.errorMessage.textContent = message;
                this.elements.errorMessage.style.display = 'block';
                this.elements.errorMessage.style.color = '#ff4444';
                setTimeout(() => this.hideError(), 5000);
            }

            showSuccess(message) {
                this.elements.errorMessage.textContent = message;
                this.elements.errorMessage.style.display = 'block';
                this.elements.errorMessage.style.color = '#4CAF50';
                setTimeout(() => this.hideError(), 3000);
            }

            hideError() {
                this.elements.errorMessage.style.display = 'none';
            }
        }

        let nexoTranslator;
        document.addEventListener('DOMContentLoaded', () => {
            nexoTranslator = new NexoTranslator();
        });
        if (document.readyState !== 'loading') {
            nexoTranslator = new NexoTranslator();
        }
    </script>
</body>
</html>
